const thisticketField = getFieldById("customfield_10143");
const context = await getContext();  // Correctly fetching context

/// Get the current issue ID
const issueId = context.extension.issue.id;

// Fetch the issue details to get the status
const res = await makeRequest(`/rest/api/3/issue/${issueId}`);
const issueStatusId = res.body.fields.status.id;

// Fetch roles for the current user in this project
const projectId = context.extension.project.id;
const getProjectRolesForCurrentUser = await makeRequest(`/rest/api/3/project/${projectId}/roledetails?currentMember=true`);
const roleNames = getProjectRolesForCurrentUser.body.map(item => item.name);

// Define the required role
const requiredRole = "Application Lead";

// Check if the user has the 'Dev Lead' role
const userHasRequiredRole = roleNames.includes(requiredRole);

// Logic to handle field visibility and editability
if (issueStatusId === "10038" && userHasRequiredRole) {
    // Make the fields visible and editable if the status is "10013" and the user has the 'Dev Lead' role
    thisticketField.setReadOnly(false);
} else {
    // Hide the fields if the status is not in the defined list
    thisticketField.setReadOnly(true);
}

